<form method="post" class="modal-form" action="{{ url_for('admin.' + model_name|lower + ('_edit' if record else '_add'), **({pk_name: record[pk_name]} if record else {})) }}">
    <input type="hidden" name="csrf_token" value="{{ csrf_token }}">
    {% for name, field in form._fields.items() %}
        <div class="form-group">
            <label for="{{ name }}">{{ field.label }}</label>
            {{ field(class="form-input") }}
            {% if field.errors %}
                <div class="error-list">
                    {% for error in field.errors %}
                        <span>{{ error }}</span>
                    {% endfor %}
                </div>
            {% endif %}
        </div>
    {% endfor %}
    <div class="form-actions">
        <button type="submit" class="btn btn-primary">Save Changes</button>
    </div>
</form>
